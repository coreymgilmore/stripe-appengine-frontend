function validateEmail(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}function doWordsMatch(a,b){return a===b}function isLongPassword(a){return!(a.length<MIN_PASSWORD_LENGTH)}function isSimplePassword(a){return BAD_PASSWORDS.indexOf(a)!==-1}function showPanelMessage(a,b,c){c.html('<div class="alert alert-'+b+'">'+a+"</div>")}function showModalMessage(a,b,c){c.html('<div class="alert alert-'+b+'">'+a+"</div>")}function getCards(){var a=$("#customer-list");$.ajax({type:"GET",url:"/card/get/all/",beforeSend:function(){console.log("Loading cards..."),a.html('<option value="Loading...">')},error:function(b){console.log(b),console.log(JSON.parse(b.responseText)),a.html('<option value="Could Not Load">')},success:function(b){console.log("Loading cards...done!");var c=b.data;return a.html(""),0===c.length?void a.html('<option value="None exist yet!" data-id="0">'):void c.forEach(function(b,c){var d=b.customer_name,e=b.id;a.append('<option value="'+d+'" data-id="'+e+'">')})}})}function getCardIdFromDataList(a){var b=a.val(),c=$("#customer-list option"),d="";return c.each(function(){var a=$(this).val(),c=$(this).data("id");if(b===a)return d=c,!1}),d}function generateExpirationYears(){console.log("Loading expiration years...");var a=$("#card-exp-year");a.html("");var b=new Date,c=b.getFullYear();a.append('<option value="0">Please choose.</option>');for(var d=c;d<c+11;d++)a.append("<option value="+d+">"+d+"</option>");console.log("Loading expiration years...done!")}function getUsers(){var a=$(".user-list");$.ajax({type:"GET",url:"/users/get/all/",beforeSend:function(){a.html('<option value="0">Loading...</option>').attr("disabled",!0)},error:function(b){a.html('<option value="0">Error (please see dev tools)</option>'),console.log(b)},success:function(b){a.html(""),a.append("<option value='0'>Please choose...</option>").attr("disabled",!1);var c=b.data;c.forEach(function(b,c){"administrator"!==b.username&&a.append('<option value="'+b.id+'">'+b.username+"</option>")})}})}function resetAddUserModal(){$("#form-new-user .username, #form-new-user .password1, #form-new-user .password2").val(""),$("#form-new-user .default").attr("checked",!0).parent("label").addClass("active").siblings("label").removeClass("active"),$(".msg").html("")}function resetChangePwdModal(){$(".user-list").val("0"),$("#form-change-pwd .password1").val(""),$("#form-change-pwd .password2").val(""),$(".msg").html("")}function resetUpdateUserModal(){$("#form-update-user label.btn").attr("disabled",!0).removeClass("active"),$("#form-update-user input[type=radio]").attr("disabled",!0).attr("checked",!1),$(".msg").html(""),$("#update-user-submit").attr("disabled",!0)}function resetAddCardPanel(){$("#customer-id").val(""),$("#customer-name").val(""),$("#cardholder-name").val(""),$("#card-number").val(""),$("#card-exp-year").val("0"),$("#card-exp-month").val("0"),$("#card-cvc").val(""),$("#card-postal-code").val("")}function resetChargeCardPanel(a){$("#charge-card .customer-name").val("").prop("disabled",!1),$("#charge-card .customer-cardholder").val(""),$("#charge-card .card-last-four").val(""),$("#charge-card .card-expiration").val(""),$("#charge-card .charge-amount").val(""),$("#charge-card .charge-invoice").val(""),$("#charge-card .charge-po").val(""),$("#charge-card-submit").prop("disabled",!1),$("#charge-card-submit").siblings(".dropdown-toggle").prop("disabled",!1),$("#charge-card .charge-amount, #charge-card .charge-invoice, #charge-card .charge-po").prop("disabled",!0),a&&$("#charge-card .msg").html("")}function resetChargeSuccessPanel(){$("#panel-charge-success .customer-name").text(""),$("#panel-charge-success .cardholder").text(""),$("#panel-charge-success .card-last4").text(""),$("#panel-charge-success .card-exp").text(""),$("#panel-charge-success .amount").text(""),$("#panel-charge-success .invoice").text(""),$("#panel-charge-success .po").text(""),$("#show-receipt").attr("href","")}const MIN_PASSWORD_LENGTH=8,BAD_PASSWORDS=["password","password1","12345678","123456789","123123123","00000000","1234567890","asdfasdf","asdfghjkl","testtest","admin@example.com"],MIN_CHARGE=.5;$("body").on("click",".action-btn",function(){const a="fast";var b=$(this).data("action"),c=$("#"+b);if(!c.hasClass("show")){var d=$(".action-panels.show");d.fadeOut(a,function(){d.removeClass("show"),c.fadeIn(a,function(){c.addClass("show")})}),resetAddCardPanel(),resetChargeCardPanel(!0)}}),$("#create-init-admin").submit(function(a){var b=$("#password1").val(),c=$("#password2").val(),d=$("#create-init-admin .msg");return doWordsMatch(b,c)===!1?(a.preventDefault(),showPanelMessage("The passwords do not match.","danger",d),!1):isLongPassword(b)===!1?(a.preventDefault(),showPanelMessage("Your password is too short. It must be at least 8 characters.","danger",d),!1):isSimplePassword(b)===!0?(a.preventDefault(),essage("The password you provided is too simple. Please choose a better password.","danger",d),!1):void 0}),$(function(){$('[data-toggle="tooltip"]').tooltip(),$.ajaxSetup({dataType:"json"})}),$("#form-new-user").submit(function(a){var b=$("#form-new-user .username").val(),c=$("#form-new-user .password1").val(),d=$("#form-new-user .password2").val(),e=$("#form-new-user .can-add-cards input:checked").val(),f=$("#form-new-user .can-remove-cards input:checked").val(),g=$("#form-new-user .can-charge-cards input:checked").val(),h=$("#form-new-user .can-view-reports input:checked").val(),i=$("#form-new-user .is-admin input:checked").val(),j=$("#form-new-user .is-active input:checked").val(),k=$("#form-new-user .msg"),l=$("#form-new-user-submit");return validateEmail(b)===!1?(a.preventDefault(),showModalMessage("You must provide an email address as a username.","danger",k),!1):doWordsMatch(c,d)===!1?(a.preventDefault(),showModalMessage("The passwords do not match.","danger",k),!1):isLongPassword(c)===!1?(a.preventDefault(),showModalMessage("Your password is too short. It must be at least 8 characters.","danger",k),!1):isSimplePassword(c)===!0?(a.preventDefault(),showModalMessage("Your password too simple. Choose a more complex password.","danger",k),!1):(k.html(""),a.preventDefault(),$.ajax({type:"POST",url:"/users/add/",data:{username:b,password1:c,password2:d,addCards:e,removeCards:f,chargeCards:g,reports:h,admin:i,active:j},beforeSend:function(){l.attr("disabled",!0),showModalMessage("Saving user...","info",k)},error:function(a){var b=JSON.parse(a.responseText);return b.ok===!1?(showModalMessage(b.data.error_msg,"danger",k),void console.log(b)):void l.attr("disabled",!1)},success:function(a){showModalMessage("New user was saved sucessfully!","success",k),setTimeout(function(){l.attr("disabled",!1),resetAddUserModal()},3e3)}}),!1)}),$("#modal-new-user").on("hidden.bs.modal",function(){resetAddUserModal()}),$("#modal-change-pwd, #modal-update-user").on("show.bs.modal",function(){getUsers()}),$("#form-change-pwd").submit(function(a){var b=$("#form-change-pwd .user-list").val(),c=$("#form-change-pwd .password1").val(),d=$("#form-change-pwd .password2").val(),e=$("#form-change-pwd .msg"),f=$("#change-password-submit");return doWordsMatch(c,d)===!1?(a.preventDefault(),showModalMessage("The passwords do not match.","danger",e),!1):isLongPassword(c)===!1?(a.preventDefault(),showModalMessage("Your password is too short. It must be at least 8 characters.","danger",e),!1):isSimplePassword(c)===!0?(a.preventDefault(),showModalMessage("Your password too simple. Choose a more complex password.","danger",e),!1):($.ajax({type:"POST",url:"/users/change-pwd/",data:{userId:b,pass1:c,pass2:d},beforeSend:function(){f.attr("disabled",!0),showModalMessage("Saving new password...","info",e)},error:function(a){showModalMessage("An error occured while trying to update this user's password.","danger",e),console.log(a)},success:function(a){showModalMessage("This user's password has been updated.","success",e),setTimeout(function(){f.attr("disabled",!1),resetChangePwdModal()},3e3)}}),a.preventDefault(),!1)}),$("#modal-change-pwd").on("hidden.bs.modal",function(){resetAddUserModal()}),$("#modal-update-user").on("hidden.bs.modal",function(){resetUpdateUserModal()}),$("#form-update-user").on("change",".user-list",function(){var a=$(this).val(),b=$("#form-update-user .msg");return 0===a?void resetUpdateUserModal():void $.ajax({type:"GET",url:"/users/get/",data:{userId:a},beforeSend:function(){resetUpdateUserModal(),showModalMessage("Retrieving user's permissions...","info",b)},error:function(a){showModalMessage("An error occured while trying to retrieve this users data. Please try again.","danger",b),console.log(a)},success:function(a){b.html(""),$("#form-update-user label.btn").attr("disabled",!1),$("#form-update-user input[type=radio]").attr("disabled",!1),$("#update-user-submit").attr("disabled",!1);var c=a.data;c.add_cards?$("#form-update-user .can-add-cards input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .can-add-cards input[value=false]").attr("checked",!0).parent().addClass("active"),c.remove_cards?$("#form-update-user .can-remove-cards input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .can-remove-cards input[value=false]").attr("checked",!0).parent().addClass("active"),c.charge_cards?$("#form-update-user .can-charge-cards input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .can-charge-cards input[value=false]").attr("checked",!0).parent().addClass("active"),c.view_reports?$("#form-update-user .can-view-reports input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .can-view-reports input[value=false]").attr("checked",!0).parent().addClass("active"),c.is_admin?$("#form-update-user .is-admin input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .is-admin input[value=false]").attr("checked",!0).parent().addClass("active"),c.is_active?$("#form-update-user .is-active input[value=true]").attr("checked",!0).parent().addClass("active"):$("#form-update-user .is-active input[value=false]").attr("checked",!0).parent().addClass("active")}})}),$("#form-update-user").submit(function(a){var b=$("#form-update-user .user-list").val(),c=$("#form-update-user .can-add-cards label.active input").val(),d=$("#form-update-user .can-remove-cards label.active input").val(),e=$("#form-update-user .can-charge-cards label.active input").val(),f=$("#form-update-user .can-view-reports label.active input").val(),g=$("#form-update-user .is-admin label.active input").val(),h=$("#form-update-user .is-active label.active input").val(),i=$("#form-update-user .msg"),j=$("#update-user-submit");return 0===b.length?(a.preventDefault(),void showModalMessage("A user must be chosen first.","danger",i)):(a.preventDefault(),$.ajax({type:"POST",url:"/users/update/",data:{userId:b,addCards:c,removeCards:d,chargeCards:e,reports:f,admin:g,active:h},beforeSend:function(){j.attr("disabled",!0),showModalMessage("Saving updated permissions...","info",i)},error:function(a){var b=JSON.parse(a.responseText);if(b.ok===!1)return showModalMessage(b.data.error_msg,"danger",i),void console.log(b)},success:function(a){showModalMessage("User updated successfully!","success",i),setTimeout(function(){j.attr("disabled",!1),i.html("")},3e3)}}),!1)}),$("#add-card").on("change","#card-exp-month",function(){var a=$(this).val(),b=new Date,c=b.getMonth()+1,d=b.getFullYear();a<c?$("#card-exp-year option[value="+d+"]").css({display:"none"}):$("#card-exp-year option[value="+d+"]").css({display:"block"})}),$("#add-card").submit(function(a){function r(a,b){return b.error?(showPanelMessage("The credit card could not be saved. Please contact an administrator. Message: "+b.error.message+".","danger",m),void console.log(b)):void $.ajax({type:"POST",url:"/card/add/",data:{customerId:c,customerName:d,cardholder:e,cardToken:b.id,cardExp:b.card.exp_month+"/"+b.card.exp_year,cardLast4:b.card.last4},error:function(a){var b=JSON.parse(a.responseText);if(console.log(b),0==b.ok)return showPanelMessage(b.data.error_msg,"danger",m),void l.prop("disabled",!1).text("Add Card")},success:function(a){resetAddCardPanel(),showPanelMessage("Card was saved!","success",m),setTimeout(function(){m.html(""),l.prop("disabled",!1).text("Add Card"),getCards()},2e3)}})}var c=($("#add-card"),$("#customer-id").val().trim()),d=$("#customer-name").val().trim(),e=$("#cardholder-name").val().trim(),f=$("#card-number").val().trim().replace(" ","").replace("-",""),g=parseInt($("#card-exp-year").val()),h=parseInt($("#card-exp-month").val()),i=$("#card-cvc").val().trim(),j=$("#card-postal-code").val().trim(),k=Stripe.card.cardType(f),l=$("#add-card .submit-form-btn"),m=$("#add-card .msg");if(m.html(""),d.length<2)return a.preventDefault(),showPanelMessage("You must provide a customer name. This can be the same as the cardholder or the name of a company. This is used to lookup cards when you want to create a charge.","danger",m),!1;if(e.length<2)return a.preventDefault(),showPanelMessage("Please provide the name of the cardholder as it is given on the card.","danger",m),!1;var n=f.length;if(n<14||n>16)return a.preventDefault(),showPanelMessage("The card number you provided is "+n+" digits long, however, it must be exactly 15 or 16 digits.","danger",m),!1;if(Stripe.card.validateCardNumber(f)===!1)return a.preventDefault(),showPanelMessage("The card number you provided is not valid.","danger",m),!1;var o=new Date,p=o.getMonth()+1,q=o.getFullYear();return 0===h||"0"===h?(a.preventDefault(),showPanelMessage("Please choose the card's expiration month.","danger",m),!1):0===g||"0"===g?(a.preventDefault(),showPanelMessage("Please choose the card's expiration year.","danger",m),!1):g===q&&h<p?(a.preventDefault(),showPanelMessage("The card's expiration must be in the future.","danger",m),!1):Stripe.card.validateExpiry(h,g)===!1?(a.preventDefault(),showPanelMessage("The card's expiration must be in the future.","danger",m),!1):Stripe.card.validateCVC(i)===!1?(a.preventDefault(),showPanelMessage("The security code you provided is invalid.","danger",m),!1):"American Express"===k&&4!==i.length?(a.preventDefault(),showPanelMessage("You provided an American Express card but your security code is invalid. The security code must be exactly 4 numbers long.","danger",m),!1):"American Express"!==k&&3!==i.length?(a.preventDefault(),showPanelMessage("You provided an "+Stripe.card.cardType(f)+" card but your security code is invalid. The security code must be exactly 3 numbers long.","danger",m),!1):j.length<5||j.length>6?(a.preventDefault(),showPanelMessage("The postal code must be exactly 5 numeric or 6 alphanumeric characters.","danger",m),!1):(l.prop("disabled",!0),showPanelMessage("Saving card...","info",m),Stripe.card.createToken({name:e,number:f,cvc:i,exp_month:h,exp_year:g,address_zip:j},r),a.preventDefault(),!1)}),$("#add-card").on("click",".clear-form-btn",function(){resetAddCardPanel(),$("#add-card .msg").html("")}),$("#remove-card").submit(function(a){var b=$("#remove-card .customer-name"),c=b.val(),d=getCardIdFromDataList(b),e=$("#remove-card .submit-form-btn"),f=$("#remove-card .msg");return 0===d||"0"===d||0===d.length?(a.preventDefault(),showPanelMessage("You must choose a customer.","danger",f),console.log("input val: "+b.val()),console.log("cust id: "+d),void console.log("cust id length: "+d.length)):($.ajax({type:"POST",url:"/card/remove/",data:{customerId:d,customerName:c},beforeSend:function(){e.prop("disabled",!0),showPanelMessage("Removing card...","info",f)},error:function(a){var b=JSON.parse(a.responseText);b.ok===!1&&(e.prop("disabled",!1),showPanelMessage("An error occured while removing this card. Do not refresh or leave this screen! Please contact an administrator.","danger",f)),console.log(a),console.log(b)},success:function(a){e.prop("disabled",!1),showPanelMessage("Card was removed!","success",f),b.val(""),setTimeout(function(){f.html(""),getCards()},2e3)}}),a.preventDefault(),!1)}),$("#charge-card").on("change",".customer-name",function(){var a=$("#charge-card .customer-name"),b=getCardIdFromDataList(a),c=$("#charge-card .msg");return c.html(""),""===b?void showPanelMessage("The customer name you provided is not a real customer. Please choose a customer from the list.","danger",c):void $.ajax({type:"GET",url:"/card/get/",data:{customerId:b},beforeSend:function(){$("#charge-card .customer-cardholder, #charge-card .card-last-four, #charge-card .card-expiration").val("Loading...")},error:function(a){var b=JSON.parse(a.responseText);showPanelMessage(b.data.error_msg,"danger",c),console.log(a)},success:function(a){var b=a.data;$("#charge-card .customer-cardholder").val(b.cardholder_name),$("#charge-card .card-last-four").val(b.card_last4),$("#charge-card .card-expiration").val(b.card_expiration),$("#charge-card .charge-amount, #charge-card .charge-invoice, #charge-card .charge-po").prop("disabled",!1)}})}),$("#charge-card").submit(function(a){var b=$("#charge-card .customer-name"),c=b.val(),d=getCardIdFromDataList(b),e=$("#charge-card .charge-amount"),f=parseFloat(e.val()),g=$("#charge-card .charge-invoice"),h=g.val(),i=$("#charge-card .charge-po"),j=i.val(),k=$("#charge-card .msg"),l=$("#charge-card-submit"),m=l.siblings(".dropdown-toggle"),n=l.data("chargeandremove")||!1;return a.preventDefault(),f<MIN_CHARGE?(a.preventDefault(),void showPanelMessage("You must provide an amount to charge greater than the minimum charge (0.5).","danger",k)):(l.data("chargeandremove",""),$.ajax({type:"POST",url:"/card/charge/",data:{datastoreId:d,customerName:c,amount:f,invoice:h,po:j,chargeAndRemove:n},beforeSend:function(){b.prop("disabled",!0),e.prop("disabled",!0),g.prop("disabled",!0),i.prop("disabled",!0),l.prop("disabled",!0),m.prop("disabled",!0),showPanelMessage("Charging card...","info",k),resetChargeSuccessPanel()},error:function(a){var b=JSON.parse(a.responseText);b.ok===!1&&(showPanelMessage(b.data.error_msg,"danger",k),console.log(b))},success:function(a){var b=a.data;$("#panel-charge-success .customer-name").text(b.customer_name),$("#panel-charge-success .cardholder").text(b.cardholder_name),$("#panel-charge-success .card-last4").text(b.card_last4),$("#panel-charge-success .card-exp").text(b.card_expiration),$("#panel-charge-success .amount").text("$"+parseFloat(b.amount).toFixed(2)),$("#panel-charge-success .invoice").text(b.invoice),$("#panel-charge-success .po").text(b.po);var c="/card/receipt/?chg_id="+b.charge_id;$("#show-receipt").attr("href",c);var e=($("#action-panels-container").outerWidth(),$("#panel-charge-card")),f=$("#panel-charge-success"),g=$(".action-btn");g.attr("disabled",!0).children("input").attr("disabled",!0),e.fadeOut(200,function(){e.removeClass("show"),f.fadeIn(200,function(){f.addClass("show"),g.attr("disabled",!1).children("input").attr("disabled",!1)})}),g.removeClass("active"),resetChargeCardPanel(!0),setTimeout(function(){getCards()},2e3)}}),!1)}),$(".dropdown-menu.charge-card-options").on("click","#charge-and-remove-card",function(){$("#charge-card-submit").data("chargeandremove",!0),$("#charge-card").submit()}),$("#charge-card").on("click",".clear-form-btn",function(){resetChargeCardPanel(!0)}),$("#reports").submit(function(a){var b=$("#reports .customer-name"),e=(b.val(),getCardIdFromDataList(b),$("#reports .start-date").val()),f=$("#reports .end-date").val(),g=$("#reports .msg");$("#reports-submit");if(g.html(""),""===e)return a.preventDefault(),void showPanelMessage("You must choose a Start Date.","danger",g);if(""===f)return a.preventDefault(),void showPanelMessage("You must choose an End Date.","danger",g);if(f<e)return a.preventDefault(),void showPanelMessage("The Start Date must be before the End Date.","danger",g);var i=new Date,j=i.getTimezoneOffset()/60*-1;$("#timezone").val(j);var b=$("#reports .customer-name"),k=getCardIdFromDataList(b);$("#report-customer-id").val(k)}),$("#report-rows").on("click",".refund",function(){var a=$(this),b=parseFloat(a.parent().siblings("td.amount-dollars").children(".amount").text().replace(",","")).toFixed(2),c=a.data("chgid"),d=$("#refund-amount");d.val(b).attr("max",b),$("#refund-chg-id").val(c)}),$("#form-refund").submit(function(a){var b=$("#refund-chg-id").val(),c=$("#refund-amount").val(),d=$("#refund-reason").val(),e=$("#form-refund .msg"),f=$("#refund-submit");return e.html(""),0===b.length?(a.preventDefault(),void showModalMessage("A charge ID was not submitted.  Please refresh your browser and try again.","danger",e)):0===c.length||parseFloat(c)<0?(a.preventDefault(),void showModalMessage("You must provide an amount to refund that is greater than zero but less than the amount charged.","danger",e)):(a.preventDefault(),$.ajax({type:"POST",url:"/card/refund/",data:{chargeId:b,amount:c,reason:d},beforeSend:function(){showModalMessage("Refunding charge...","info",e),f.prop("disabled",!0)},error:function(a){var b=JSON.parse(a.responseText);b.ok===!1&&(showModalMessage(b.data.error_msg,"danger",e),f.prop("disabled",!1),console.log(b))},success:function(a){showModalMessage("Refund successful!","success",e),f.prop("disabled",!1),$("#refund-amount").val(""),$("#refund-reason").val("0")}}),!1)}),$("#modal-change-company-info").on("show.bs.modal",function(){var a=$("#modal-change-company-info .msg");$.ajax({type:"GET",url:"/company/get/",beforeSend:function(){showModalMessage("Loading company information...","info",a)},error:function(b){var c=JSON.parse(b.responseText);if(c.ok===!1)return"companyInfoDoesNotExist"===c.data.error_type?void showModalMessage("You do have any company info set. Your recipts will show up blank without setting the fields above.","info",a):(showModalMessage("An error occured and your company data could not be loaded.  Please try again.","danger",a),void $("#company-info-submit").prop("disabled",!0))},success:function(b){var c=b.data;$("#modal-change-company-info .company-name").val(c.company_name),$("#modal-change-company-info .company-street").val(c.street),$("#modal-change-company-info .company-suite").val(c.suite),$("#modal-change-company-info .company-city").val(c.city),$("#modal-change-company-info .company-state").val(c.state),$("#modal-change-company-info .company-postal").val(c.postal_code),$("#modal-change-company-info .company-country").val(c.country),$("#modal-change-company-info .company-phone").val(c.phone_num),a.html(""),$("#company-info-submit").prop("disabled",!1)}})}),$("#modal-change-company-info").on("hidden.bs.modal",function(){$("#modal-change-company-info .msg").html(""),$("#company-info-submit").prop("disabled",!0),$("#modal-change-company-info input").val("")}),$("#form-change-company-info").submit(function(a){a.preventDefault();var b=$("#modal-change-company-info .company-name").val(),c=$("#modal-change-company-info .company-street").val(),d=$("#modal-change-company-info .company-suite").val(),e=$("#modal-change-company-info .company-city").val(),f=$("#modal-change-company-info .company-state").val(),g=$("#modal-change-company-info .company-postal").val(),h=$("#modal-change-company-info .company-country").val(),i=$("#modal-change-company-info .company-phone").val(),j=$("#modal-change-company-info .msg"),k=$("#company-info-submit");return f.length>2?void showModalMessage("State must be a two character abbreviation.","danger",j):g.length>6?void showModalMessage("Postal code must be 5 or 6 alphanumeric characters.","danger",j):h.length>3?void showModalMessage("Country must be a 2 or 3 character abbreviation.","danger",j):($.ajax({type:"POST",url:"/company/set/",data:{name:b,street:c,suite:d,city:e,state:f,postal:g,country:h,phone:i},beforeSend:function(){showModalMessage("Saving company information...","info",j),k.prop("disabled",!0)},error:function(a){var b=JSON.parse(a.responseText);if(b.ok===!1)return showModalMessage("An error occured and your company info could not be saved.","danger",j),void console.log(b)},success:function(a){showModalMessage("Company information was saved!","success",j),k.prop("disabled",!1),setTimeout(function(){j.html("")},3e3)}}),!1)});